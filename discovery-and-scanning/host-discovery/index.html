<!doctype html><html lang=en-us dir=ltr><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=description content="Host Discovery #  At a Glance #  One of the first steps during the network enumeration is to reduce a set of IPs into a list of active or interesting hosts. Depending on if you are inside the network or scanning remotely, how much noise you can make, and your discovery requirements, different tools, and options are available.
Internal #  Passive #  Passive discovery relies on monitoring network layer traffic to detect network topology, services, and applications."><meta name=theme-color content="#FFFFFF"><meta name=color-scheme content="light dark"><meta property="og:title" content="Host Discovery"><meta property="og:description" content="Host Discovery #  At a Glance #  One of the first steps during the network enumeration is to reduce a set of IPs into a list of active or interesting hosts. Depending on if you are inside the network or scanning remotely, how much noise you can make, and your discovery requirements, different tools, and options are available.
Internal #  Passive #  Passive discovery relies on monitoring network layer traffic to detect network topology, services, and applications."><meta property="og:type" content="article"><meta property="og:url" content="https://0xffsec.com/handbook/discovery-and-scanning/host-discovery/"><meta property="og:image" content="https://0xffsec.com/handbook/images/banner.png"><meta property="article:section" content="discovery-and-scanning"><meta property="article:modified_time" content="2022-07-03T13:26:29+02:00"><meta itemprop=name content="Host Discovery"><meta itemprop=description content="Host Discovery #  At a Glance #  One of the first steps during the network enumeration is to reduce a set of IPs into a list of active or interesting hosts. Depending on if you are inside the network or scanning remotely, how much noise you can make, and your discovery requirements, different tools, and options are available.
Internal #  Passive #  Passive discovery relies on monitoring network layer traffic to detect network topology, services, and applications."><meta itemprop=dateModified content="2022-07-03T13:26:29+02:00"><meta itemprop=wordCount content="528"><meta itemprop=image content="https://0xffsec.com/handbook/images/banner.png"><meta itemprop=keywords content><meta name=twitter:card content="summary_large_image"><meta name=twitter:image content="https://0xffsec.com/handbook/images/banner.png"><meta name=twitter:title content="Host Discovery"><meta name=twitter:description content="Host Discovery #  At a Glance #  One of the first steps during the network enumeration is to reduce a set of IPs into a list of active or interesting hosts. Depending on if you are inside the network or scanning remotely, how much noise you can make, and your discovery requirements, different tools, and options are available.
Internal #  Passive #  Passive discovery relies on monitoring network layer traffic to detect network topology, services, and applications."><title>Host Discovery | 0xffsec Handbook</title><link rel=manifest href=https://0xffsec.com/handbook/manifest.json><link rel=icon href=https://0xffsec.com/handbook/favicon.png type=image/x-icon><link rel=stylesheet href=https://0xffsec.com/handbook/book.min.d49b15b58fa9e1961e9b869764b7bf320cb91db58ac5a303597bdb2dab198adc.css integrity="sha256-1JsVtY+p4ZYem4aXZLe/Mgy5HbWKxaMDWXvbLasZitw=" crossorigin=anonymous><script defer src=https://0xffsec.com/handbook/flexsearch.min.js></script><script defer src=https://0xffsec.com/handbook/en.search.min.6ac1ddb14a810cd31e9e434441869e8691d77b4351aa838cc3d79f4db7a56f81.js integrity="sha256-asHdsUqBDNMenkNEQYaehpHXe0NRqoOMw9efTbelb4E=" crossorigin=anonymous></script><script type=application/javascript>var doNotTrack=!1;doNotTrack||(function(a,e,f,g,b,c,d){a.GoogleAnalyticsObject=b,a[b]=a[b]||function(){(a[b].q=a[b].q||[]).push(arguments)},a[b].l=1*new Date,c=e.createElement(f),d=e.getElementsByTagName(f)[0],c.async=1,c.src=g,d.parentNode.insertBefore(c,d)}(window,document,'script','https://www.google-analytics.com/analytics.js','ga'),ga('create','UA-142676329-2','auto'),ga('send','pageview'))</script><link rel=apple-touch-icon sizes=180x180 href=https://0xffsec.com/handbook/images/apple-touch-icon.png><link rel=icon type=image/png sizes=96x96 href=https://0xffsec.com/handbook/images/favicon-96x96.png><link rel=icon type=image/png sizes=32x32 href=https://0xffsec.com/handbook/images/favicon-32x32.png><link rel=icon type=image/png sizes=16x16 href=https://0xffsec.com/handbook/images/favicon-16x16.png></head><body dir=ltr><input type=checkbox class="hidden toggle" id=menu-control>
<input type=checkbox class="hidden toggle" id=toc-control><main class="container flex"><aside class=book-menu><div class=book-menu-content><nav><h2 class=book-brand><a class="flex align-center" href=https://0xffsec.com/handbook/><img src=https://0xffsec.com/handbook/images/logo.png alt=Logo><span>0xffsec Handbook</span></a></h2><div class=book-search><input type=text id=book-search-input placeholder=Search aria-label=Search maxlength=64 data-hotkeys=s/><div class="book-search-spinner hidden"></div><ul id=book-search-results></ul></div><ul><li><input type=checkbox id=section-35d81374824c25dc2919edbbc61d971f class=toggle>
<label for=section-35d81374824c25dc2919edbbc61d971f class="flex justify-between"><a role=button>Information Gathering</a></label><ul><li><a href=https://0xffsec.com/handbook/information-gathering/assets-discovery/>Assets Discovery</a></li><li><a href=https://0xffsec.com/handbook/information-gathering/subdomain-enumeration/>Subdomain Enumeration</a></li></ul></li><li><input type=checkbox id=section-235f64cfc2023c9b7289c228d0c51f53 class=toggle checked>
<label for=section-235f64cfc2023c9b7289c228d0c51f53 class="flex justify-between"><a role=button>Discovery and Scanning</a></label><ul><li><a href=https://0xffsec.com/handbook/discovery-and-scanning/host-discovery/ class=active>Host Discovery</a></li><li><a href=https://0xffsec.com/handbook/discovery-and-scanning/port-scanning/>Port Scanning</a></li></ul></li><li><a href=https://0xffsec.com/handbook/exploits-search/>Exploit Search</a></li><li><a href=https://0xffsec.com/handbook/brute-forcing/>Brute Forcing</a></li><li><input type=checkbox id=section-057108a1c1a3662b9db6ab679412fa8f class=toggle>
<label for=section-057108a1c1a3662b9db6ab679412fa8f class="flex justify-between"><a href=https://0xffsec.com/handbook/services/>Service Enumeration</a></label><ul><li><a href=https://0xffsec.com/handbook/services/ftp/>FTP - 21</a></li><li><a href=https://0xffsec.com/handbook/services/smtp/>SMTP - 25 / 465 / 587</a></li><li><a href=https://0xffsec.com/handbook/services/dns/>DNS - 53</a></li><li><a href=https://0xffsec.com/handbook/services/finger/>Finger - 79</a></li><li><a href=https://0xffsec.com/handbook/services/http-https/>HTTP/S - 80 / 443</a></li><li><a href=https://0xffsec.com/handbook/services/pop/>POP - 110 / 995</a></li><li><a href=https://0xffsec.com/handbook/services/nntp/>NNTP - 119 / 433 / 563</a></li><li><a href=https://0xffsec.com/handbook/services/msrpc/>MSRPC - 135 / 593</a></li><li><a href=https://0xffsec.com/handbook/services/netbios/>NetBIOS - 137 / 138 / 139</a></li><li><a href=https://0xffsec.com/handbook/services/smb/>SMB - 139 / 445</a></li><li><a href=https://0xffsec.com/handbook/services/imap/>IMAP - 143 / 993</a></li></ul></li><li><a href=https://0xffsec.com/handbook/steganography/>Steganography</a></li><li><input type=checkbox id=section-4710461fd82136af748c8186e2a511e1 class=toggle>
<label for=section-4710461fd82136af748c8186e2a511e1 class="flex justify-between"><a role=button>Web Applications</a></label><ul><li><a href=https://0xffsec.com/handbook/web-applications/cgi/>CGI</a></li><li><a href=https://0xffsec.com/handbook/web-applications/command-injection/>Command Injection</a></li><li><a href=https://0xffsec.com/handbook/web-applications/csrf/>CSRF</a></li><li><a href=https://0xffsec.com/handbook/web-applications/file-inclusion-and-path-traversal/>LFI / RFI and Path Traversal</a></li></ul></li><li><input type=checkbox id=section-9b274a52224e37b079acf4aae5f9f128 class=toggle>
<label for=section-9b274a52224e37b079acf4aae5f9f128 class="flex justify-between"><a role=button>Shells</a></label><ul><li><a href=https://0xffsec.com/handbook/shells/reverse-shells/>Reverse Shells</a></li><li><a href=https://0xffsec.com/handbook/shells/full-tty/>Upgrade to Full TTY</a></li><li><a href=https://0xffsec.com/handbook/shells/restricted-shells/>Escape Restricted Shells</a></li></ul></li><li><a href=https://0xffsec.com/handbook/exfiltration/>Data Exfiltration</a></li><li><input type=checkbox id=section-ef46fe0aac274900fefdd5e564e236b2 class=toggle>
<label for=section-ef46fe0aac274900fefdd5e564e236b2 class="flex justify-between"><a href=https://0xffsec.com/handbook/notes/>Notes</a></label><ul><li><a href=https://0xffsec.com/handbook/notes/how-to-open-jar-files/>JAR Files</a></li><li><a href=https://0xffsec.com/handbook/notes/smb-protocol-negotiation-failed/>SMB Protocol Negotiation Failed</a></li><li><a href=https://0xffsec.com/handbook/notes/ssh-legacy-key-exchange/>SSH Legacy Key Exchange</a></li></ul></li><li><a href=https://0xffsec.com/handbook/further-reading/>Further Reading</a></li></ul><ul><li><a href=https://github.com/0xffsec/handbook target=_blank rel=noopener>GitHub</a></li></ul></nav><script>(function(){var a=document.querySelector("aside .book-menu-content");addEventListener("beforeunload",function(b){localStorage.setItem("menu.scrollTop",a.scrollTop)}),a.scrollTop=localStorage.getItem("menu.scrollTop")})()</script></div></aside><div class=book-page><header class=book-header><div class="flex align-center justify-between"><label for=menu-control><img src=https://0xffsec.com/handbook/svg/menu.svg class=book-icon alt=Menu></label>
<strong>Host Discovery</strong>
<label for=toc-control><img src=https://0xffsec.com/handbook/svg/toc.svg class=book-icon alt="Table of Contents"></label></div><aside class="hidden clearfix"><nav id=TableOfContents><ul><li><a href=#at-a-glance>At a Glance</a></li><li><a href=#internal>Internal</a><ul><li><a href=#passive>Passive</a></li><li><a href=#active>Active</a></li><li><a href=#icmp>ICMP</a></li></ul></li><li><a href=#external>External</a><ul><li><a href=#icmp-1>ICMP</a></li><li><a href=#port-discovery>Port Discovery</a></li></ul></li></ul></nav></aside></header><article class=markdown><h1 id=host-discovery>Host Discovery
<a class=anchor href=#host-discovery>#</a></h1><h2 id=at-a-glance>At a Glance
<a class=anchor href=#at-a-glance>#</a></h2><p>One of the first steps
during the network enumeration
is to reduce a set of IPs
into a list of active or interesting hosts.
Depending on if you are inside the network
or scanning remotely,
how much noise you can make,
and your discovery requirements,
different tools,
and options are available.</p><h2 id=internal>Internal
<a class=anchor href=#internal>#</a></h2><h3 id=passive>Passive
<a class=anchor href=#passive>#</a></h3><p>Passive discovery relies on
monitoring network layer traffic
to detect network topology,
services,
and applications.</p><p>As no packets are injected into the network,
there is no risk of unintentional service disruption.
It is also suitable for
finding intermittently offered
or protected services
often missed by active scanning.
<sup id=fnref:1><a href=#fn:1 class=footnote-ref role=doc-noteref>1</a></sup></p><h4 id=netdiscover---arp-netdiscover>netdiscover - ARP <sup id=fnref:2><a href=#fn:2 class=footnote-ref role=doc-noteref>2</a></sup>
<a class=anchor href=#netdiscover---arp-netdiscover>#</a></h4><div class=highlight><pre style=color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sh data-lang=sh>sudo netdiscover -p
</code></pre></div><ul><li><code>-p</code>: passive mode. It does not send anything, but <strong>does only sniff</strong>.</li></ul><h4 id=p0f---fingerprinting-p0f>p0f - Fingerprinting <sup id=fnref:3><a href=#fn:3 class=footnote-ref role=doc-noteref>3</a></sup>
<a class=anchor href=#p0f---fingerprinting-p0f>#</a></h4><div class=highlight><pre style=color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sh data-lang=sh>sudo p0f -p
</code></pre></div><ul><li><code>-p</code>: promiscuous mode; by default, it listens only to packet addressed or routed through.
<strong>On IP-enabled interfaces can be detected remotely</strong>.</li></ul><h4 id=bettercap-bettercap-recon>bettercap <sup id=fnref:4><a href=#fn:4 class=footnote-ref role=doc-noteref>4</a></sup>
<a class=anchor href=#bettercap-bettercap-recon>#</a></h4><div class=highlight><pre style=color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-txt data-lang=txt>net.recon on
net.show.meta true
net.show
</code></pre></div><h3 id=active>Active
<a class=anchor href=#active>#</a></h3><p>In contrast,
active discovery does inject
a variety of packets into the network.</p><p>It is well suited for open port discovery
and fingerprinting.
However,
these techniques are not without drawbacks.
Scans can be invasive,
generate too much noise,
and in some cases,
cause service interruptions
due to the type of packets sent.</p><h4 id=netdiscover---arp-netdiscover-1>netdiscover - ARP <sup id=fnref:2><a href=#fn:2 class=footnote-ref role=doc-noteref>2</a></sup>
<a class=anchor href=#netdiscover---arp-netdiscover-1>#</a></h4><div class=highlight><pre style=color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sh data-lang=sh>sudo netdiscover -r 10.0.0.0/24
</code></pre></div><ul><li><code>-r &lt;range></code>: scan a given range instead of auto scan.</li></ul><h4 id=nmap>Nmap
<a class=anchor href=#nmap>#</a></h4><div class=highlight><pre style=color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sh data-lang=sh>nmap -sn 10.0.0.0/24
</code></pre></div><ul><li><code>-sn</code>: No port scan AKA <strong>ping scan</strong>. <sup id=fnref:5><a href=#fn:5 class=footnote-ref role=doc-noteref>5</a></sup>
Consists of an ICMP echo request, TCP SYN to port 443, TCP ACK to port 80, and an ICMP timestamp request by default.</li></ul><h4 id=nbtscan---netbios-nbtscan>nbtscan - NetBIOS <sup id=fnref:6><a href=#fn:6 class=footnote-ref role=doc-noteref>6</a></sup>
<a class=anchor href=#nbtscan---netbios-nbtscan>#</a></h4><div class=highlight><pre style=color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sh data-lang=sh>sudo nbtscan 10.0.0.0/24
</code></pre></div><h4 id=bettercap-bettercap-probe>bettercap <sup id=fnref:7><a href=#fn:7 class=footnote-ref role=doc-noteref>7</a></sup>
<a class=anchor href=#bettercap-bettercap-probe>#</a></h4><div class=highlight><pre style=color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sh data-lang=sh>net.probe on
net.show.meta <span style=color:#24909d>true</span>
net.show
</code></pre></div><h3 id=icmp>ICMP
<a class=anchor href=#icmp>#</a></h3><p>Refer to <a href=#icmp-1>External ICMP Scanning</a></p><h2 id=external>External
<a class=anchor href=#external>#</a></h2><h3 id=icmp-1>ICMP
<a class=anchor href=#icmp-1>#</a></h3><p>As defined in <a href=https://tools.ietf.org/html/rfc792>RFC 792</a>, ICMP messages are typically used for diagnostic or control purposes or generated in response to errors in IP operations (as specified in <a href=https://tools.ietf.org/html/rfc1122>RFC 1122</a>).<sup id=fnref:8><a href=#fn:8 class=footnote-ref role=doc-noteref>8</a></sup>
Although it is possible to use ICMP requests to discover if a host is up or not, it is common to find all these packets being filtered, making it an unreliable method.</p><h4 id=ping>ping
<a class=anchor href=#ping>#</a></h4><div class=highlight><pre style=color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sh data-lang=sh>ping -c <span style=color:#3677a9>1</span> 10.0.0.3
</code></pre></div><ul><li><code>-c &lt;count></code>: stops after <code>count</code> replies.</li></ul><h4 id=fping-fping>fping <sup id=fnref:9><a href=#fn:9 class=footnote-ref role=doc-noteref>9</a></sup>
<a class=anchor href=#fping-fping>#</a></h4><div class=highlight><pre style=color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sh data-lang=sh>fping -g 10.0.0.0/24
</code></pre></div><ul><li><code>-g, --generate &lt;target></code>: generates target list. <code>target</code> can be start and end IP or a CIDR address.</li></ul><h4 id=nmap-1>Nmap
<a class=anchor href=#nmap-1>#</a></h4><div class=highlight><pre style=color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sh data-lang=sh>nmap -PEPM -sn -n 10.0.0.0/24
</code></pre></div><details><summary>Parameters</summary><div class=markdown-inner><ul><li><code>-PE; -PP; -PM</code>: ICMP echo, timestamp, and netmask request discovery probes.</li><li><code>-sn</code>: No port scan.</li><li><code>-n</code>: No DNS resolution.</li></ul></div></details><h3 id=port-discovery>Port Discovery
<a class=anchor href=#port-discovery>#</a></h3><p>Another commonly used technique is port scanning. It allows you to identify running services, consequently, interesting hosts.
See <a href=https://0xffsec.com/handbook/discovery-and-scanning/port-scanning/>Port Scanning</a>.</p><section class=footnotes role=doc-endnotes><hr><ol><li id=fn:1 role=doc-endnote><p>Whyte, David. Network Scanning Detection Strategies for Enterprise Networks. Sept. 2008, pp. 12-22 <a href=https://pdfs.semanticscholar.org/bb60/dc6cf24ea1f17126511e0998d3c55bdd50f9.pdf>https://pdfs.semanticscholar.org/bb60/dc6cf24ea1f17126511e0998d3c55bdd50f9.pdf</a>.&#160;<a href=#fnref:1 class=footnote-backref role=doc-backlink>&#8617;&#xfe0e;</a></p></li><li id=fn:2 role=doc-endnote><p>“GitHub - Netdiscover-Scanner/Netdiscover: Netdiscover, ARP Scanner (Official Repository).” GitHub, <a href=https://github.com/netdiscover-scanner/netdiscover>https://github.com/netdiscover-scanner/netdiscover</a>.&#160;<a href=#fnref:2 class=footnote-backref role=doc-backlink>&#8617;&#xfe0e;</a></p></li><li id=fn:3 role=doc-endnote><p>Zalewski, Michal. “P0f V3.” [Lcamtuf.Coredump.Cx], <a href=https://lcamtuf.coredump.cx/p0f3/>https://lcamtuf.coredump.cx/p0f3/</a>.&#160;<a href=#fnref:3 class=footnote-backref role=doc-backlink>&#8617;&#xfe0e;</a></p></li><li id=fn:4 role=doc-endnote><p>“Bettercap:: Net.Recon.” Bettercap, <a href=https://www.bettercap.org/modules/ethernet/net.recon/>https://www.bettercap.org/modules/ethernet/net.recon/</a>.&#160;<a href=#fnref:4 class=footnote-backref role=doc-backlink>&#8617;&#xfe0e;</a></p></li><li id=fn:5 role=doc-endnote><p>“Host Discovery | Nmap Network Scanning.” Nmap: The Network Mapper - Free Security Scanner, <a href=https://nmap.org/book/man-host-discovery.html>https://nmap.org/book/man-host-discovery.html</a>.&#160;<a href=#fnref:5 class=footnote-backref role=doc-backlink>&#8617;&#xfe0e;</a></p></li><li id=fn:6 role=doc-endnote><p>“NETBIOS Nameserver Scanner.” Steve Friedl’s Home Page, <a href=http://www.unixwiz.net/tools/nbtscan.html>http://www.unixwiz.net/tools/nbtscan.html</a>.&#160;<a href=#fnref:6 class=footnote-backref role=doc-backlink>&#8617;&#xfe0e;</a></p></li><li id=fn:7 role=doc-endnote><p>“Bettercap:: Net.Probe.” Bettercap, <a href=https://www.bettercap.org/modules/ethernet/net.probe/>https://www.bettercap.org/modules/ethernet/net.probe/</a>.&#160;<a href=#fnref:7 class=footnote-backref role=doc-backlink>&#8617;&#xfe0e;</a></p></li><li id=fn:8 role=doc-endnote><p>Forouzan, Behrouz A. Data Communications and Networking. Huga Media, 2007, pp. 621–630.&#160;<a href=#fnref:8 class=footnote-backref role=doc-backlink>&#8617;&#xfe0e;</a></p></li><li id=fn:9 role=doc-endnote><p>Schweikert, David. “Fping.” Fping Homepage, <a href=https://fping.org/>https://fping.org/</a>.&#160;<a href=#fnref:9 class=footnote-backref role=doc-backlink>&#8617;&#xfe0e;</a></p></li></ol></section></article><footer class=book-footer><div class="flex flex-wrap justify-between"><div><a class="flex align-center" href=https://github.com/0xffsec/handbook/commit/d231750e6ace235c5c2995467dc27fe1f5377ced title="Last modified by Max Rodrigo | July 3, 2022" target=_blank rel=noopener><img src=https://0xffsec.com/handbook/svg/calendar.svg class=book-icon alt=Calendar>
<span>July 3, 2022</span></a></div><div><a class="flex align-center" href=https://github.com/0xffsec/handbook/edit/master/content/content/discovery-and-scanning/host-discovery.md target=_blank rel=noopener><img src=https://0xffsec.com/handbook/svg/edit.svg class=book-icon alt=Edit>
<span>Edit this page</span></a></div></div><script>(function(){function a(c){const a=window.getSelection(),b=document.createRange();b.selectNodeContents(c),a.removeAllRanges(),a.addRange(b)}document.querySelectorAll("pre code").forEach(b=>{b.addEventListener("click",function(c){a(b.parentElement),navigator.clipboard&&navigator.clipboard.writeText(b.parentElement.textContent)})})})()</script></footer><div class=book-comments></div><label for=menu-control class="hidden book-menu-overlay"></label></div><aside class=book-toc><div class=book-toc-content><nav id=TableOfContents><ul><li><a href=#at-a-glance>At a Glance</a></li><li><a href=#internal>Internal</a><ul><li><a href=#passive>Passive</a></li><li><a href=#active>Active</a></li><li><a href=#icmp>ICMP</a></li></ul></li><li><a href=#external>External</a><ul><li><a href=#icmp-1>ICMP</a></li><li><a href=#port-discovery>Port Discovery</a></li></ul></li></ul></nav></div></aside></main></body></html>