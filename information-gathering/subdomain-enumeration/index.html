<!doctype html><html lang=en-us dir=ltr><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=description content="The ultimate subdomain enumeration guide for bugbounty and security assestments."><meta name=theme-color content="#FFFFFF"><meta name=color-scheme content="light dark"><meta property="og:title" content="Subdomain Enumeration: The Ultimate Guide"><meta property="og:description" content="The ultimate subdomain enumeration guide for bugbounty and security assestments."><meta property="og:type" content="article"><meta property="og:url" content="https://0xffsec.com/handbook/information-gathering/subdomain-enumeration/"><meta property="og:image" content="https://0xffsec.com/handbook/images/banner.png"><meta property="article:section" content="information-gathering"><meta property="article:modified_time" content="2022-07-03T13:26:29+02:00"><meta itemprop=name content="Subdomain Enumeration: The Ultimate Guide"><meta itemprop=description content="The ultimate subdomain enumeration guide for bugbounty and security assestments."><meta itemprop=dateModified content="2022-07-03T13:26:29+02:00"><meta itemprop=wordCount content="968"><meta itemprop=image content="https://0xffsec.com/handbook/images/banner.png"><meta itemprop=keywords content><meta name=twitter:card content="summary_large_image"><meta name=twitter:image content="https://0xffsec.com/handbook/images/banner.png"><meta name=twitter:title content="Subdomain Enumeration: The Ultimate Guide"><meta name=twitter:description content="The ultimate subdomain enumeration guide for bugbounty and security assestments."><title>Subdomain Enumeration: The Ultimate Guide | 0xffsec Handbook</title><link rel=manifest href=https://0xffsec.com/handbook/manifest.json><link rel=icon href=https://0xffsec.com/handbook/favicon.png type=image/x-icon><link rel=stylesheet href=https://0xffsec.com/handbook/book.min.d49b15b58fa9e1961e9b869764b7bf320cb91db58ac5a303597bdb2dab198adc.css integrity="sha256-1JsVtY+p4ZYem4aXZLe/Mgy5HbWKxaMDWXvbLasZitw=" crossorigin=anonymous><script defer src=https://0xffsec.com/handbook/flexsearch.min.js></script><script defer src=https://0xffsec.com/handbook/en.search.min.6ac1ddb14a810cd31e9e434441869e8691d77b4351aa838cc3d79f4db7a56f81.js integrity="sha256-asHdsUqBDNMenkNEQYaehpHXe0NRqoOMw9efTbelb4E=" crossorigin=anonymous></script><script type=application/javascript>var doNotTrack=!1;doNotTrack||(function(a,e,f,g,b,c,d){a.GoogleAnalyticsObject=b,a[b]=a[b]||function(){(a[b].q=a[b].q||[]).push(arguments)},a[b].l=1*new Date,c=e.createElement(f),d=e.getElementsByTagName(f)[0],c.async=1,c.src=g,d.parentNode.insertBefore(c,d)}(window,document,'script','https://www.google-analytics.com/analytics.js','ga'),ga('create','UA-142676329-2','auto'),ga('send','pageview'))</script><link rel=apple-touch-icon sizes=180x180 href=https://0xffsec.com/handbook/images/apple-touch-icon.png><link rel=icon type=image/png sizes=96x96 href=https://0xffsec.com/handbook/images/favicon-96x96.png><link rel=icon type=image/png sizes=32x32 href=https://0xffsec.com/handbook/images/favicon-32x32.png><link rel=icon type=image/png sizes=16x16 href=https://0xffsec.com/handbook/images/favicon-16x16.png></head><body dir=ltr><input type=checkbox class="hidden toggle" id=menu-control>
<input type=checkbox class="hidden toggle" id=toc-control><main class="container flex"><aside class=book-menu><div class=book-menu-content><nav><h2 class=book-brand><a class="flex align-center" href=https://0xffsec.com/handbook/><img src=https://0xffsec.com/handbook/images/logo.png alt=Logo><span>0xffsec Handbook</span></a></h2><div class=book-search><input type=text id=book-search-input placeholder=Search aria-label=Search maxlength=64 data-hotkeys=s/><div class="book-search-spinner hidden"></div><ul id=book-search-results></ul></div><ul><li><input type=checkbox id=section-35d81374824c25dc2919edbbc61d971f class=toggle checked>
<label for=section-35d81374824c25dc2919edbbc61d971f class="flex justify-between"><a role=button>Information Gathering</a></label><ul><li><a href=https://0xffsec.com/handbook/information-gathering/assets-discovery/>Assets Discovery</a></li><li><a href=https://0xffsec.com/handbook/information-gathering/subdomain-enumeration/ class=active>Subdomain Enumeration</a></li></ul></li><li><input type=checkbox id=section-235f64cfc2023c9b7289c228d0c51f53 class=toggle>
<label for=section-235f64cfc2023c9b7289c228d0c51f53 class="flex justify-between"><a role=button>Discovery and Scanning</a></label><ul><li><a href=https://0xffsec.com/handbook/discovery-and-scanning/host-discovery/>Host Discovery</a></li><li><a href=https://0xffsec.com/handbook/discovery-and-scanning/port-scanning/>Port Scanning</a></li></ul></li><li><a href=https://0xffsec.com/handbook/exploits-search/>Exploit Search</a></li><li><a href=https://0xffsec.com/handbook/brute-forcing/>Brute Forcing</a></li><li><input type=checkbox id=section-057108a1c1a3662b9db6ab679412fa8f class=toggle>
<label for=section-057108a1c1a3662b9db6ab679412fa8f class="flex justify-between"><a href=https://0xffsec.com/handbook/services/>Service Enumeration</a></label><ul><li><a href=https://0xffsec.com/handbook/services/ftp/>FTP - 21</a></li><li><a href=https://0xffsec.com/handbook/services/smtp/>SMTP - 25 / 465 / 587</a></li><li><a href=https://0xffsec.com/handbook/services/dns/>DNS - 53</a></li><li><a href=https://0xffsec.com/handbook/services/finger/>Finger - 79</a></li><li><a href=https://0xffsec.com/handbook/services/http-https/>HTTP/S - 80 / 443</a></li><li><a href=https://0xffsec.com/handbook/services/pop/>POP - 110 / 995</a></li><li><a href=https://0xffsec.com/handbook/services/nntp/>NNTP - 119 / 433 / 563</a></li><li><a href=https://0xffsec.com/handbook/services/msrpc/>MSRPC - 135 / 593</a></li><li><a href=https://0xffsec.com/handbook/services/netbios/>NetBIOS - 137 / 138 / 139</a></li><li><a href=https://0xffsec.com/handbook/services/smb/>SMB - 139 / 445</a></li><li><a href=https://0xffsec.com/handbook/services/imap/>IMAP - 143 / 993</a></li></ul></li><li><a href=https://0xffsec.com/handbook/steganography/>Steganography</a></li><li><input type=checkbox id=section-4710461fd82136af748c8186e2a511e1 class=toggle>
<label for=section-4710461fd82136af748c8186e2a511e1 class="flex justify-between"><a role=button>Web Applications</a></label><ul><li><a href=https://0xffsec.com/handbook/web-applications/cgi/>CGI</a></li><li><a href=https://0xffsec.com/handbook/web-applications/command-injection/>Command Injection</a></li><li><a href=https://0xffsec.com/handbook/web-applications/csrf/>CSRF</a></li><li><a href=https://0xffsec.com/handbook/web-applications/file-inclusion-and-path-traversal/>LFI / RFI and Path Traversal</a></li></ul></li><li><input type=checkbox id=section-9b274a52224e37b079acf4aae5f9f128 class=toggle>
<label for=section-9b274a52224e37b079acf4aae5f9f128 class="flex justify-between"><a role=button>Shells</a></label><ul><li><a href=https://0xffsec.com/handbook/shells/reverse-shells/>Reverse Shells</a></li><li><a href=https://0xffsec.com/handbook/shells/full-tty/>Upgrade to Full TTY</a></li><li><a href=https://0xffsec.com/handbook/shells/restricted-shells/>Escape Restricted Shells</a></li></ul></li><li><a href=https://0xffsec.com/handbook/exfiltration/>Data Exfiltration</a></li><li><input type=checkbox id=section-ef46fe0aac274900fefdd5e564e236b2 class=toggle>
<label for=section-ef46fe0aac274900fefdd5e564e236b2 class="flex justify-between"><a href=https://0xffsec.com/handbook/notes/>Notes</a></label><ul><li><a href=https://0xffsec.com/handbook/notes/how-to-open-jar-files/>JAR Files</a></li><li><a href=https://0xffsec.com/handbook/notes/smb-protocol-negotiation-failed/>SMB Protocol Negotiation Failed</a></li><li><a href=https://0xffsec.com/handbook/notes/ssh-legacy-key-exchange/>SSH Legacy Key Exchange</a></li></ul></li><li><a href=https://0xffsec.com/handbook/further-reading/>Further Reading</a></li></ul><ul><li><a href=https://github.com/0xffsec/handbook target=_blank rel=noopener>GitHub</a></li></ul></nav><script>(function(){var a=document.querySelector("aside .book-menu-content");addEventListener("beforeunload",function(b){localStorage.setItem("menu.scrollTop",a.scrollTop)}),a.scrollTop=localStorage.getItem("menu.scrollTop")})()</script></div></aside><div class=book-page><header class=book-header><div class="flex align-center justify-between"><label for=menu-control><img src=https://0xffsec.com/handbook/svg/menu.svg class=book-icon alt=Menu></label>
<strong>Subdomain Enumeration: The Ultimate Guide</strong>
<label for=toc-control><img src=https://0xffsec.com/handbook/svg/toc.svg class=book-icon alt="Table of Contents"></label></div><aside class="hidden clearfix"><nav id=TableOfContents><ul><li><a href=#at-a-glance>At a Glance</a><ul><li></li></ul></li><li><a href=#tools>Tools</a><ul><li></li></ul></li><li><a href=#certificate-transparency>Certificate Transparency</a><ul><li></li></ul></li><li><a href=#google-dorking>Google Dorking</a></li><li><a href=#dns-aggregators>DNS Aggregators</a></li><li><a href=#asn-enumeration>ASN Enumeration</a></li><li><a href=#subject-alternate-name-san>Subject Alternate Name (SAN)</a><ul><li></li></ul></li><li><a href=#rapid7-forward-dns-dataset>Rapid7 Forward DNS dataset</a></li><li><a href=#brute-force-enumeration>Brute Force Enumeration</a><ul><li></li></ul></li><li><a href=#dns>DNS</a><ul><li><a href=#zone-transfer>Zone Transfer</a></li><li><a href=#cname-records>CNAME Records</a></li><li><a href=#spf-records>SPF Records</a></li></ul></li><li><a href=#http-headers>HTTP Headers</a><ul><li><a href=#content-security-policy-csp>Content Security Policy (CSP)</a></li></ul></li><li><a href=#further-reading>Further Reading</a></li></ul></nav></aside></header><article class=markdown><h1 id=subdomain-enumeration>Subdomain Enumeration
<a class=anchor href=#subdomain-enumeration>#</a></h1><h2 id=at-a-glance>At a Glance
<a class=anchor href=#at-a-glance>#</a></h2><p>Sub-domain enumeration is
the process of finding sub-domains
for one or more domains.
It helps to broader the attack surface,
find hidden applications,
and forgotten subdomains.</p><div class=book-note><div class=book-note-icon><svg width="23" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path d="M256 60a15 15 0 000 30c50 0 90 40 90 90a15 15 0 0030 0c0-66-54-120-120-120z"/><path d="M217 4a179 179 0 00-96 295c19 22 30 49 30 77v30c0 20 13 37 31 43 6 35 36 63 74 63s68-28 74-63c18-6 31-23 31-43v-30c0-28 11-55 30-78A180 180 0 00217 4zm39 478c-19 0-36-13-42-31h84c-6 18-23 31-42 31zm75-76c0 8-7 15-15 15H196c-8 0-15-7-15-15v-15h150v15zm38-127c-21 24-34 52-37 82H180c-3-30-16-59-36-82a150 150 0 11225 0zM45 180H15a15 15 0 000 30h30a15 15 0 000-30z"/><path d="M51 105 30 84A15 15 0 109 105l21 21a15 15 0 1021-21zm0 159c-6-6-15-6-21 0L9 285a15 15 0 1021 21l21-21c6-6 6-15 0-21zm446-84h-30a15 15 0 000 30h30a15 15 0 000-30zm6-96c-6-6-15-6-21 0l-21 21a15 15 0 1021 21l21-21c6-6 6-15 0-21zm0 201-21-21a15 15 0 10-21 21l21 21a15 15 0 0021-21z"/></svg></div><div class=book-note-text><p><b>Note:</b>
Vulnerabilities tend to be present
across multiple domains and applications
of the same organization.</p></div></div><h4 id=passive-enumeration>Passive Enumeration
<a class=anchor href=#passive-enumeration>#</a></h4><ul><li><a href=#certificate-transparency>Certificate Transparency</a></li><li><a href=#google-dorking>Google Dorking</a></li><li><a href=#dns-aggregators>DNS Aggregators</a></li><li><a href=#asn-enumeration>ASN Enumeration</a></li><li><a href=#subject-alternate-name-san>Subject Alternate Name (SAN)</a></li><li><a href=#rapid7-forward-dns-dataset>Rapid7 Forward DNS dataset</a></li></ul><h4 id=active-enumeration>Active Enumeration
<a class=anchor href=#active-enumeration>#</a></h4><ul><li><a href=#brute-force-enumeration>Brute Force Enumeration</a></li><li><a href=#zone-transfer>Zone Transfer</a></li><li><a href=#dns-records>DNS Records</a></li><li><a href=#content-security-policy-csp-header>Content Security Policy (CSP) Header</a></li></ul><h2 id=tools>Tools
<a class=anchor href=#tools>#</a></h2><h4 id=amass-amass>Amass <sup id=fnref:1><a href=#fn:1 class=footnote-ref role=doc-noteref>1</a></sup>
<a class=anchor href=#amass-amass>#</a></h4><div class=highlight><pre style=color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sh data-lang=sh>amass enum -passive -d example.com -o results.txt
</code></pre></div><details><summary>Parameters</summary><div class=markdown-inner><ul><li><code>--passive</code>: Disable DNS resolution names and dependent features.</li><li><code>-d</code>: Domain names separated by commas.</li><li><code>-o</code>: Path to the text file containing terminal <code>stdout</code>/<code>stderr</code>.</li></ul></div></details><h4 id=sublist3r-sublist3r>sublist3r <sup id=fnref:2><a href=#fn:2 class=footnote-ref role=doc-noteref>2</a></sup>
<a class=anchor href=#sublist3r-sublist3r>#</a></h4><div class=highlight><pre style=color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sh data-lang=sh>sublist3r -d example.com
</code></pre></div><h2 id=certificate-transparency>Certificate Transparency
<a class=anchor href=#certificate-transparency>#</a></h2><p>Certificate Transparency (CT) is an Internet security standard
and open-source framework
for monitoring and auditing digital certificates.
It creates a system of public logs
to record all certificates issued by publicly trusted CAs,
allowing efficient identification of mistakenly
or maliciously issued certificates.<sup id=fnref:3><a href=#fn:3 class=footnote-ref role=doc-noteref>3</a></sup></p><p>Some CT Logs search engines:</p><ul><li><a href=https://crt.sh/>https://crt.sh/</a></li><li><a href=https://censys.io/>https://censys.io/</a></li><li><a href=https://developers.facebook.com/tools/ct/>https://developers.facebook.com/tools/ct/</a></li><li><a href=https://google.com/transparencyreport/https/ct/>https://google.com/transparencyreport/https/ct/</a></li></ul><h4 id=massdns-massdns>massdns <sup id=fnref:4><a href=#fn:4 class=footnote-ref role=doc-noteref>4</a></sup>
<a class=anchor href=#massdns-massdns>#</a></h4><div class=highlight><pre style=color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sh data-lang=sh>./scripts/ct.py example.com | ./bin/massdns -r ./lists/resolvers.txt -o S -w results.txt
</code></pre></div><details><summary>Parameters</summary><div class=markdown-inner><ul><li><code>-r</code>: Text file containing DNS resolvers.</li><li><code>-o</code>: Flags for output formatting.</li><li><code>-w</code>: Write to the specified output file.</li></ul></div></details><h4 id=crtsh-postgresql-interface><code>crt.sh</code> PostgreSQL Interface
<a class=anchor href=#crtsh-postgresql-interface>#</a></h4><div class=highlight><pre style=color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sh data-lang=sh><span style=color:#cd2828;font-weight:700>#!/bin/sh
</span><span style=color:#cd2828;font-weight:700></span>
<span style=color:#40ffff>query</span>=<span style=color:#ed9d13>&#34;SELECT ci.NAME_VALUE NAME_VALUE FROM certificate_identity ci WHERE ci.NAME_TYPE = &#39;dNSName&#39; AND reverse(lower(ci.NAME_VALUE)) LIKE reverse(lower(&#39;%.</span><span style=color:#40ffff>$1</span><span style=color:#ed9d13>&#39;));&#34;</span>

(<span style=color:#24909d>echo</span> <span style=color:#40ffff>$1</span>; <span style=color:#24909d>echo</span> <span style=color:#40ffff>$query</span> | <span style=color:#ed9d13>\
</span><span style=color:#ed9d13></span>    psql -t -h crt.sh -p <span style=color:#3677a9>5432</span> -U guest certwatch | <span style=color:#ed9d13>\
</span><span style=color:#ed9d13></span>    sed -e <span style=color:#ed9d13>&#39;s:^ *::g&#39;</span> -e <span style=color:#ed9d13>&#39;s:^*\.::g&#39;</span> -e <span style=color:#ed9d13>&#39;/^$/d&#39;</span> | <span style=color:#ed9d13>\
</span><span style=color:#ed9d13></span>    sed -e <span style=color:#ed9d13>&#39;s:*.::g&#39;</span>;) | sort -u
</code></pre></div><h2 id=google-dorking>Google Dorking
<a class=anchor href=#google-dorking>#</a></h2><p>Use the <code>site:</code> operator to filter
results for the given domain.
Generally,
&ldquo;<code>*</code>&rdquo; matches any token,
meaning,
an entire term without spaces.</p><div class=highlight><pre style=color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-text data-lang=text>site:*.example.com
</code></pre></div><div class=book-note><div class=book-note-icon><svg width="23" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path d="M256 60a15 15 0 000 30c50 0 90 40 90 90a15 15 0 0030 0c0-66-54-120-120-120z"/><path d="M217 4a179 179 0 00-96 295c19 22 30 49 30 77v30c0 20 13 37 31 43 6 35 36 63 74 63s68-28 74-63c18-6 31-23 31-43v-30c0-28 11-55 30-78A180 180 0 00217 4zm39 478c-19 0-36-13-42-31h84c-6 18-23 31-42 31zm75-76c0 8-7 15-15 15H196c-8 0-15-7-15-15v-15h150v15zm38-127c-21 24-34 52-37 82H180c-3-30-16-59-36-82a150 150 0 11225 0zM45 180H15a15 15 0 000 30h30a15 15 0 000-30z"/><path d="M51 105 30 84A15 15 0 109 105l21 21a15 15 0 1021-21zm0 159c-6-6-15-6-21 0L9 285a15 15 0 1021 21l21-21c6-6 6-15 0-21zm446-84h-30a15 15 0 000 30h30a15 15 0 000-30zm6-96c-6-6-15-6-21 0l-21 21a15 15 0 1021 21l21-21c6-6 6-15 0-21zm0 201-21-21a15 15 0 10-21 21l21 21a15 15 0 0021-21z"/></svg></div><div class=book-note-text><p><b>Note:</b><p>Other search engines,
like <a href=https://www.bing.com>Bing</a> and <a href=http://www.duckduckgo.com>DuckDuckGo</a>,
offer similar advanced search operators:</p><ul><li><a href=https://help.bing.microsoft.com/#apex/bing/en-us/10001/-1>Bing Advanced Search Keywords</a></li><li><a href=https://help.duckduckgo.com/duckduckgo-help-pages/results/syntax/>DuckDuckGo Search Syntax</a></li><li><a href=https://docs.google.com/document/d/1ydVaJJeL1EYbWtlfj9TPfBTE5IBADkQfZrQaBZxqXGs/edit>Google Advanced Search Operators</a></li></ul></p></div></div><h2 id=dns-aggregators>DNS Aggregators
<a class=anchor href=#dns-aggregators>#</a></h2><ul><li><a href=https://www.virustotal.com/>VirusTotal Passive DNS replication</a><sup id=fnref:5><a href=#fn:5 class=footnote-ref role=doc-noteref>5</a></sup></li><li><a href=https://dnsdumpster.com/>DNSDumpster</a></li><li><a href=https://searchdns.netcraft.com/>Netcraft - Search DNS</a></li></ul><h2 id=asn-enumeration>ASN Enumeration
<a class=anchor href=#asn-enumeration>#</a></h2><p>Refer to <a href=https://0xffsec.com/handbook/information-gathering/assets-discovery/#asn-enumeration>ASN Enumeration</a></p><h2 id=subject-alternate-name-san>Subject Alternate Name (SAN)
<a class=anchor href=#subject-alternate-name-san>#</a></h2><p>Subject Alternative Name (SAN) is an extension to X.509
that allows additional values
to be associated
with an SSL certificate.
These values, or Names, include
email addresses, URIs, DNS names,
directory names,
and more.
<sup id=fnref:6><a href=#fn:6 class=footnote-ref role=doc-noteref>6</a></sup></p><h4 id=openssl-openssl>OpenSSL <sup id=fnref:7><a href=#fn:7 class=footnote-ref role=doc-noteref>7</a></sup>
<a class=anchor href=#openssl-openssl>#</a></h4><div class=highlight><pre style=color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sh data-lang=sh><span style=color:#24909d>true</span> | openssl s_client -connect example.com:443 2&gt;/dev/null | openssl x509 -noout -text  | perl -l -0777 -ne <span style=color:#ed9d13>&#39;@names=/\bDNS:([^\s,]+)/g; print join(&#34;\n&#34;, sort @names);&#39;</span>
</code></pre></div><details><summary>Parameters</summary><div class=markdown-inner><ul><li><code>s_client</code>: SSL/TLS client program.</li><li><code>x509</code>: output a <a href=https://en.wikipedia.org/wiki/X.509>x590 structure</a> instead of a certificate request.</li><li><code>-noout</code>: Inhibits the output of the encoded version of the parameters.</li><li><code>-text</code>: Prints out the EC parameters in human readable form.</li></ul></div></details><h2 id=rapid7-forward-dns-dataset>Rapid7 Forward DNS dataset
<a class=anchor href=#rapid7-forward-dns-dataset>#</a></h2><p>The dataset contains
the responses to DNS requests
for all forward DNS names
known by <a href=https://www.rapid7.com/research/project-sonar/>Rapid7&rsquo;s Project Sonar</a>.</p><p><a href=https://opendata.rapid7.com/sonar.fdns_v2/>Download Rapid7 Forward DNS datasets</a>.</p><h2 id=brute-force-enumeration>Brute Force Enumeration
<a class=anchor href=#brute-force-enumeration>#</a></h2><p>Useful Wordlists:</p><ul><li>Jhaddix&rsquo;s <a href=https://gist.github.com/jhaddix/86a06c5dc309d08580a018c66354a056>all.txt</a></li><li>Daniel Miessler&rsquo;s <a href=https://github.com/danielmiessler/SecLists/tree/master/Discovery/DNS>DNS Discovery</a>.</li><li><a href=https://github.com/assetnote/commonspeak2-wordlists>Commonspeak2</a></li></ul><h4 id=amass-amass-1>Amass <sup id=fnref:1><a href=#fn:1 class=footnote-ref role=doc-noteref>1</a></sup>
<a class=anchor href=#amass-amass-1>#</a></h4><div class=highlight><pre style=color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sh data-lang=sh>amass enum -brute -w subdomains.txt -d example.com -o results.txt
</code></pre></div><details><summary>Parameters</summary><div class=markdown-inner><ul><li><code>-brute</code>: Execute brute forcing after searches.</li><li><code>-w</code>: Path to wordlist file.</li><li><code>-d</code>: Domain names separated by commas.</li><li><code>-o</code>: Path to the text file containing terminal <code>stdout</code>/<code>stderr</code>.</li></ul></div></details><h4 id=massdns-massdns-1>massdns <sup id=fnref:4><a href=#fn:4 class=footnote-ref role=doc-noteref>4</a></sup>
<a class=anchor href=#massdns-massdns-1>#</a></h4><div class=highlight><pre style=color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sh data-lang=sh>./scripts/subbrute.py subdomains.txt example.com | ./bin/massdns -r ./lists/resolvers.txt -o S -w results.txt
</code></pre></div><details><summary>Parameters</summary><div class=markdown-inner><ul><li><code>-r</code>: Text file containing DNS resolvers.</li><li><code>-o</code>: Flags for output formatting.</li><li><code>-w</code>: Write to the specified output file.</li></ul></div></details><h4 id=gobuster-gobuster>gobuster <sup id=fnref:8><a href=#fn:8 class=footnote-ref role=doc-noteref>8</a></sup>
<a class=anchor href=#gobuster-gobuster>#</a></h4><div class=highlight><pre style=color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sh data-lang=sh>gobuster dns -t <span style=color:#3677a9>30</span> -w subdomains.txt -d example.com
</code></pre></div><details><summary>Parameters</summary><div class=markdown-inner><ul><li><code>dns</code>: DNS subdomain bruteforcing mode.</li><li><code>-d</code>: target domain.</li><li><code>-t &lt;n></code>: number of concurrent threads (default 10).</li><li><code>-w &lt;wordlist></code>: path to the wordlist.</li></ul></div></details><h2 id=dns>DNS
<a class=anchor href=#dns>#</a></h2><h3 id=zone-transfer>Zone Transfer
<a class=anchor href=#zone-transfer>#</a></h3><p>DNS zone transfer is one mechanism
to replicate DNS databases across DNS servers.</p><div class=book-note><div class=book-note-icon><svg width="23" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path d="M256 60a15 15 0 000 30c50 0 90 40 90 90a15 15 0 0030 0c0-66-54-120-120-120z"/><path d="M217 4a179 179 0 00-96 295c19 22 30 49 30 77v30c0 20 13 37 31 43 6 35 36 63 74 63s68-28 74-63c18-6 31-23 31-43v-30c0-28 11-55 30-78A180 180 0 00217 4zm39 478c-19 0-36-13-42-31h84c-6 18-23 31-42 31zm75-76c0 8-7 15-15 15H196c-8 0-15-7-15-15v-15h150v15zm38-127c-21 24-34 52-37 82H180c-3-30-16-59-36-82a150 150 0 11225 0zM45 180H15a15 15 0 000 30h30a15 15 0 000-30z"/><path d="M51 105 30 84A15 15 0 109 105l21 21a15 15 0 1021-21zm0 159c-6-6-15-6-21 0L9 285a15 15 0 1021 21l21-21c6-6 6-15 0-21zm446-84h-30a15 15 0 000 30h30a15 15 0 000-30zm6-96c-6-6-15-6-21 0l-21 21a15 15 0 1021 21l21-21c6-6 6-15 0-21zm0 201-21-21a15 15 0 10-21 21l21 21a15 15 0 0021-21z"/></svg></div><div class=book-note-text><p><b>Note:</b>
Data transfer process
begins by the client
sending a AXFR query
to the server.</p></div></div><p>More under DNS Service Enumeration <a href=https://0xffsec.com/handbook/services/dns/#zone-transfer>Zone Transfers</a></p><h4 id=dnsrecon-dnsrecon>dnsrecon <sup id=fnref:9><a href=#fn:9 class=footnote-ref role=doc-noteref>9</a></sup>
<a class=anchor href=#dnsrecon-dnsrecon>#</a></h4><div class=highlight><pre style=color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sh data-lang=sh>dnsrecon -a -d tesla.com
</code></pre></div><details><summary>Parameters</summary><div class=markdown-inner><ul><li><code>-a</code>: Perform AXFR with standard enumeration.</li><li><code>-d</code>: Domain.</li></ul></div></details><h4 id=dig>dig
<a class=anchor href=#dig>#</a></h4><div class=highlight><pre style=color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sh data-lang=sh>dig axfr @ns1.example.com example.com
</code></pre></div><details><summary>Parameters</summary><div class=markdown-inner><ul><li><code>axfr</code>: initiate an <em>AXFR</em> zone transfer query.</li><li><code>@ns1.example.com</code>: name or IP of the server to query.</li><li><code>example.com</code>: name of the resource record that is to be looked up.</li></ul></div></details><h3 id=cname-records>CNAME Records
<a class=anchor href=#cname-records>#</a></h3><p>A Canonical NAME record (CNAME)
is a type of DNS record
that maps one domain name (an alias)
to another (the canonical name).</p><p>CNAMEs may reveal
an organization&rsquo;s sub-domains
and information about running services.</p><h4 id=dig-1>dig
<a class=anchor href=#dig-1>#</a></h4><div class=highlight><pre style=color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sh data-lang=sh>dig +short -x <span style=color:#ed9d13>`</span>dig +short example.com<span style=color:#ed9d13>`</span>
</code></pre></div><details><summary>Parameters</summary><div class=markdown-inner><ul><li><code>+short</code>: Provide a terse answer.</li><li><code>-x &lt;addr></code>: Simplified reverse lookups, for mapping addresses to names.</li></ul></div></details><h3 id=spf-records>SPF Records
<a class=anchor href=#spf-records>#</a></h3><p>A Sender Policy Framework record (SPF)
is a type of TXT DNS record
used as an email authentication method.
It specifies the mail servers
authorized to send emails for your domain.</p><p>SPF helps protect domains from spoofing.</p><div class=book-note><div class=book-note-icon><svg width="23" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path d="M256 60a15 15 0 000 30c50 0 90 40 90 90a15 15 0 0030 0c0-66-54-120-120-120z"/><path d="M217 4a179 179 0 00-96 295c19 22 30 49 30 77v30c0 20 13 37 31 43 6 35 36 63 74 63s68-28 74-63c18-6 31-23 31-43v-30c0-28 11-55 30-78A180 180 0 00217 4zm39 478c-19 0-36-13-42-31h84c-6 18-23 31-42 31zm75-76c0 8-7 15-15 15H196c-8 0-15-7-15-15v-15h150v15zm38-127c-21 24-34 52-37 82H180c-3-30-16-59-36-82a150 150 0 11225 0zM45 180H15a15 15 0 000 30h30a15 15 0 000-30z"/><path d="M51 105 30 84A15 15 0 109 105l21 21a15 15 0 1021-21zm0 159c-6-6-15-6-21 0L9 285a15 15 0 1021 21l21-21c6-6 6-15 0-21zm446-84h-30a15 15 0 000 30h30a15 15 0 000-30zm6-96c-6-6-15-6-21 0l-21 21a15 15 0 1021 21l21-21c6-6 6-15 0-21zm0 201-21-21a15 15 0 10-21 21l21 21a15 15 0 0021-21z"/></svg></div><div class=book-note-text><p><b>Note:</b>
Applications may have internal netblocks
listed in their SPF record.</p></div></div><h4 id=dig-2>dig
<a class=anchor href=#dig-2>#</a></h4><div class=highlight><pre style=color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sh data-lang=sh>dig +short TXT example.com
</code></pre></div><details><summary>Parameters</summary><div class=markdown-inner><ul><li><code>+short</code>: Provide a terse answer.</li></ul></div></details><h2 id=http-headers>HTTP Headers
<a class=anchor href=#http-headers>#</a></h2><h3 id=content-security-policy-csp>Content Security Policy (CSP)
<a class=anchor href=#content-security-policy-csp>#</a></h3><p>The HTTP <code>Content-Security-Policy</code> response header
allows website administrators
to control resources the browser is allowed to load
for a given page.</p><div class=book-note><div class=book-note-icon><svg width="23" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path d="M256 60a15 15 0 000 30c50 0 90 40 90 90a15 15 0 0030 0c0-66-54-120-120-120z"/><path d="M217 4a179 179 0 00-96 295c19 22 30 49 30 77v30c0 20 13 37 31 43 6 35 36 63 74 63s68-28 74-63c18-6 31-23 31-43v-30c0-28 11-55 30-78A180 180 0 00217 4zm39 478c-19 0-36-13-42-31h84c-6 18-23 31-42 31zm75-76c0 8-7 15-15 15H196c-8 0-15-7-15-15v-15h150v15zm38-127c-21 24-34 52-37 82H180c-3-30-16-59-36-82a150 150 0 11225 0zM45 180H15a15 15 0 000 30h30a15 15 0 000-30z"/><path d="M51 105 30 84A15 15 0 109 105l21 21a15 15 0 1021-21zm0 159c-6-6-15-6-21 0L9 285a15 15 0 1021 21l21-21c6-6 6-15 0-21zm446-84h-30a15 15 0 000 30h30a15 15 0 000-30zm6-96c-6-6-15-6-21 0l-21 21a15 15 0 1021 21l21-21c6-6 6-15 0-21zm0 201-21-21a15 15 0 10-21 21l21 21a15 15 0 0021-21z"/></svg></div><div class=book-note-text><p><b>Note:</b>
There are deprecated forms of CSP headers,
they are <code>X-Content-Security-Policy</code> and <code>X-Webkit-CSP</code></p></div></div><h4 id=curl>curl
<a class=anchor href=#curl>#</a></h4><div class=highlight><pre style=color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sh data-lang=sh>curl -I -s -L https://www.maxrodrigo.com | grep -iE <span style=color:#ed9d13>&#39;Content-Security|CSP&#39;</span>
</code></pre></div><details><summary>Parameters</summary><div class=markdown-inner><ul><li><code>-I</code>: Fetch the headers only.</li><li><code>-s</code>: Quiet mode.</li><li><code>-L</code>: Follow 3XX redirections.</li></ul></div></details><h2 id=further-reading>Further Reading
<a class=anchor href=#further-reading>#</a></h2><ul><li><a href=https://www.certificate-transparency.org/what-is-ct>What is Certificate Transparency</a></li><li><a href=https://appsecco.com/books/subdomain-enumeration/>The Art of Subdomain Enumeration</a></li><li><a href=https://cr.yp.to/djbdns/axfr-notes.html>How AXFR Protocol Works</a></li><li><a href=https://blog.rapid7.com/2015/02/23/osint-through-sender-policy-framework-spf-records/>OSINT Through Sender Policy Framework (SPF) Records</a></li></ul><section class=footnotes role=doc-endnotes><hr><ol><li id=fn:1 role=doc-endnote><p>“GitHub - OWASP/Amass: In-Depth Attack Surface Mapping and Asset Discovery.” GitHub, <a href=https://github.com/OWASP/Amass>https://github.com/OWASP/Amass</a>.&#160;<a href=#fnref:1 class=footnote-backref role=doc-backlink>&#8617;&#xfe0e;</a></p></li><li id=fn:2 role=doc-endnote><p>aboul3la. “GitHub - Aboul3la/Sublist3r: Fast Subdomains Enumeration Tool for Penetration Testers.” GitHub, <a href=https://github.com/aboul3la/Sublist3r>https://github.com/aboul3la/Sublist3r</a>.&#160;<a href=#fnref:2 class=footnote-backref role=doc-backlink>&#8617;&#xfe0e;</a></p></li><li id=fn:3 role=doc-endnote><p>“What Is Certificate Transparency?” Certificate Transparency, <a href=https://www.certificate-transparency.org/what-is-ct>https://www.certificate-transparency.org/what-is-ct</a>.&#160;<a href=#fnref:3 class=footnote-backref role=doc-backlink>&#8617;&#xfe0e;</a></p></li><li id=fn:4 role=doc-endnote><p>blechschmidt. “GitHub - Blechschmidt/Massdns: A High-Performance DNS Stub Resolver for Bulk Lookups and Reconnaissance.” GitHub, <a href=https://github.com/blechschmidt/massdns>https://github.com/blechschmidt/massdns</a>.&#160;<a href=#fnref:4 class=footnote-backref role=doc-backlink>&#8617;&#xfe0e;</a></p></li><li id=fn:5 role=doc-endnote><p>“VirusTotal += Passive DNS Replication .” VirusTotal Blog, <a href=https://blog.virustotal.com/2013/04/virustotal-passive-dns-replication.html>https://blog.virustotal.com/2013/04/virustotal-passive-dns-replication.html</a>.&#160;<a href=#fnref:5 class=footnote-backref role=doc-backlink>&#8617;&#xfe0e;</a></p></li><li id=fn:6 role=doc-endnote><p>OpenSSL Foundation, Inc. “X509v3_config.” OpenSSL, <a href=https://www.openssl.org/docs/manmaster/man5/x509v3_config.html#Subject-Alternative-Name>https://www.openssl.org/docs/manmaster/man5/x509v3_config.html#Subject-Alternative-Name</a>.&#160;<a href=#fnref:6 class=footnote-backref role=doc-backlink>&#8617;&#xfe0e;</a></p></li><li id=fn:7 role=doc-endnote><p>OpenSSL Foundation, Inc. “/Docs/Manmaster/Man1/Openssl.Html.” OpenSSL.Org, <a href=https://www.openssl.org/docs/manmaster/man1/openssl.html>https://www.openssl.org/docs/manmaster/man1/openssl.html</a>.&#160;<a href=#fnref:7 class=footnote-backref role=doc-backlink>&#8617;&#xfe0e;</a></p></li><li id=fn:8 role=doc-endnote><p>Reeves, OJ. “GitHub - OJ/Gobuster.” GitHub, <a href=https://github.com/OJ/gobuster>https://github.com/OJ/gobuster</a>.&#160;<a href=#fnref:8 class=footnote-backref role=doc-backlink>&#8617;&#xfe0e;</a></p></li><li id=fn:9 role=doc-endnote><p>darkoperator. “GitHub - Darkoperator/Dnsrecon: DNS Enumeration Script.” GitHub, <a href=https://github.com/darkoperator/dnsrecon>https://github.com/darkoperator/dnsrecon</a>.&#160;<a href=#fnref:9 class=footnote-backref role=doc-backlink>&#8617;&#xfe0e;</a></p></li></ol></section></article><footer class=book-footer><div class="flex flex-wrap justify-between"><div><a class="flex align-center" href=https://github.com/0xffsec/handbook/commit/d231750e6ace235c5c2995467dc27fe1f5377ced title="Last modified by Max Rodrigo | July 3, 2022" target=_blank rel=noopener><img src=https://0xffsec.com/handbook/svg/calendar.svg class=book-icon alt=Calendar>
<span>July 3, 2022</span></a></div><div><a class="flex align-center" href=https://github.com/0xffsec/handbook/edit/master/content/content/information-gathering/subdomain-enumeration.md target=_blank rel=noopener><img src=https://0xffsec.com/handbook/svg/edit.svg class=book-icon alt=Edit>
<span>Edit this page</span></a></div></div><script>(function(){function a(c){const a=window.getSelection(),b=document.createRange();b.selectNodeContents(c),a.removeAllRanges(),a.addRange(b)}document.querySelectorAll("pre code").forEach(b=>{b.addEventListener("click",function(c){a(b.parentElement),navigator.clipboard&&navigator.clipboard.writeText(b.parentElement.textContent)})})})()</script></footer><div class=book-comments></div><label for=menu-control class="hidden book-menu-overlay"></label></div><aside class=book-toc><div class=book-toc-content><nav id=TableOfContents><ul><li><a href=#at-a-glance>At a Glance</a><ul><li></li></ul></li><li><a href=#tools>Tools</a><ul><li></li></ul></li><li><a href=#certificate-transparency>Certificate Transparency</a><ul><li></li></ul></li><li><a href=#google-dorking>Google Dorking</a></li><li><a href=#dns-aggregators>DNS Aggregators</a></li><li><a href=#asn-enumeration>ASN Enumeration</a></li><li><a href=#subject-alternate-name-san>Subject Alternate Name (SAN)</a><ul><li></li></ul></li><li><a href=#rapid7-forward-dns-dataset>Rapid7 Forward DNS dataset</a></li><li><a href=#brute-force-enumeration>Brute Force Enumeration</a><ul><li></li></ul></li><li><a href=#dns>DNS</a><ul><li><a href=#zone-transfer>Zone Transfer</a></li><li><a href=#cname-records>CNAME Records</a></li><li><a href=#spf-records>SPF Records</a></li></ul></li><li><a href=#http-headers>HTTP Headers</a><ul><li><a href=#content-security-policy-csp>Content Security Policy (CSP)</a></li></ul></li><li><a href=#further-reading>Further Reading</a></li></ul></nav></div></aside></main></body></html>